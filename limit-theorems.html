<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Limit theorems | Statistics and Data Science Applications</title>
  <meta name="description" content="This is the script for the course." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Limit theorems | Statistics and Data Science Applications" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is the script for the course." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Limit theorems | Statistics and Data Science Applications" />
  
  <meta name="twitter:description" content="This is the script for the course." />
  

<meta name="author" content="Maria Osipenko" />


<meta name="date" content="2024-04-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="some-important-distribution-models.html"/>
<link rel="next" href="iii-inductive-statistics.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-goals-and-context"><i class="fa fa-check"></i>Course goals and context</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-goals"><i class="fa fa-check"></i>Course goals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="random-events-and-probability---a-short-review.html"><a href="random-events-and-probability---a-short-review.html"><i class="fa fa-check"></i><b>1</b> Random events and probability - a short review</a>
<ul>
<li class="chapter" data-level="1.1" data-path="random-events-and-probability---a-short-review.html"><a href="random-events-and-probability---a-short-review.html#outcomes-and-events"><i class="fa fa-check"></i><b>1.1</b> Outcomes and Events</a></li>
<li class="chapter" data-level="1.2" data-path="random-events-and-probability---a-short-review.html"><a href="random-events-and-probability---a-short-review.html#probabilities"><i class="fa fa-check"></i><b>1.2</b> Probabilities</a>
<ul>
<li class="chapter" data-level="" data-path="random-events-and-probability---a-short-review.html"><a href="random-events-and-probability---a-short-review.html#laplaces-probability-model"><i class="fa fa-check"></i>Laplace‚Äôs probability model</a></li>
<li class="chapter" data-level="" data-path="random-events-and-probability---a-short-review.html"><a href="random-events-and-probability---a-short-review.html#finite-probability-spaces"><i class="fa fa-check"></i>Finite probability spaces</a></li>
<li class="chapter" data-level="" data-path="random-events-and-probability---a-short-review.html"><a href="random-events-and-probability---a-short-review.html#calculating-with-probabilities"><i class="fa fa-check"></i>Calculating with probabilities</a></li>
<li class="chapter" data-level="" data-path="random-events-and-probability---a-short-review.html"><a href="random-events-and-probability---a-short-review.html#joint-and-conditional-probabilities-independence-of-events"><i class="fa fa-check"></i>Joint and conditional probabilities, independence of events</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="random-events-and-probability---a-short-review.html"><a href="random-events-and-probability---a-short-review.html#sampling-as-a-random-process"><i class="fa fa-check"></i><b>1.3</b> Sampling as a random process</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="random-variables.html"><a href="random-variables.html"><i class="fa fa-check"></i><b>2</b> Random variables</a>
<ul>
<li class="chapter" data-level="2.1" data-path="random-variables.html"><a href="random-variables.html#discrete-random-variable"><i class="fa fa-check"></i><b>2.1</b> Discrete random variable</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="random-variables.html"><a href="random-variables.html#probability-and-distribution-functions"><i class="fa fa-check"></i><b>2.1.1</b> Probability and distribution functions</a></li>
<li class="chapter" data-level="2.1.2" data-path="random-variables.html"><a href="random-variables.html#expected-value-and-variance"><i class="fa fa-check"></i><b>2.1.2</b> Expected value and variance</a></li>
<li class="chapter" data-level="2.1.3" data-path="random-variables.html"><a href="random-variables.html#covariance-and-correlation"><i class="fa fa-check"></i><b>2.1.3</b> Covariance and correlation</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="random-variables.html"><a href="random-variables.html#continuous-random-variables"><i class="fa fa-check"></i><b>2.2</b> Continuous random variables</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="random-variables.html"><a href="random-variables.html#density-function"><i class="fa fa-check"></i><b>2.2.1</b> Density function</a></li>
<li class="chapter" data-level="2.2.2" data-path="random-variables.html"><a href="random-variables.html#distribution-function-1"><i class="fa fa-check"></i><b>2.2.2</b> Distribution function</a></li>
<li class="chapter" data-level="2.2.3" data-path="random-variables.html"><a href="random-variables.html#expected-value-and-variance-1"><i class="fa fa-check"></i><b>2.2.3</b> Expected value and variance</a></li>
<li class="chapter" data-level="2.2.4" data-path="random-variables.html"><a href="random-variables.html#quantiles-of-continuous-random-variables"><i class="fa fa-check"></i><b>2.2.4</b> Quantiles of continuous random variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="some-important-distribution-models.html"><a href="some-important-distribution-models.html"><i class="fa fa-check"></i><b>3</b> Some important distribution models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="some-important-distribution-models.html"><a href="some-important-distribution-models.html#discrete-distributions"><i class="fa fa-check"></i><b>3.1</b> Discrete distributions</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="some-important-distribution-models.html"><a href="some-important-distribution-models.html#discrete-uniform-distribution"><i class="fa fa-check"></i><b>3.1.1</b> Discrete uniform distribution</a></li>
<li class="chapter" data-level="3.1.2" data-path="some-important-distribution-models.html"><a href="some-important-distribution-models.html#bernoulli-distribution"><i class="fa fa-check"></i><b>3.1.2</b> Bernoulli distribution</a></li>
<li class="chapter" data-level="3.1.3" data-path="some-important-distribution-models.html"><a href="some-important-distribution-models.html#binomial-distribution"><i class="fa fa-check"></i><b>3.1.3</b> Binomial distribution</a></li>
<li class="chapter" data-level="3.1.4" data-path="some-important-distribution-models.html"><a href="some-important-distribution-models.html#geometric-distribution"><i class="fa fa-check"></i><b>3.1.4</b> Geometric distribution</a></li>
<li class="chapter" data-level="3.1.5" data-path="some-important-distribution-models.html"><a href="some-important-distribution-models.html#poisson-distribution"><i class="fa fa-check"></i><b>3.1.5</b> Poisson distribution</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="some-important-distribution-models.html"><a href="some-important-distribution-models.html#continuous-distributions"><i class="fa fa-check"></i><b>3.2</b> Continuous distributions</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="some-important-distribution-models.html"><a href="some-important-distribution-models.html#normal-distribution"><i class="fa fa-check"></i><b>3.2.1</b> Normal distribution</a></li>
<li class="chapter" data-level="3.2.2" data-path="some-important-distribution-models.html"><a href="some-important-distribution-models.html#exponential-distribution"><i class="fa fa-check"></i><b>3.2.2</b> Exponential distribution</a></li>
<li class="chapter" data-level="3.2.3" data-path="some-important-distribution-models.html"><a href="some-important-distribution-models.html#uniform-distribution"><i class="fa fa-check"></i><b>3.2.3</b> Uniform distribution</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="some-important-distribution-models.html"><a href="some-important-distribution-models.html#further-distributions"><i class="fa fa-check"></i><b>3.3</b> Further distributions</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="some-important-distribution-models.html"><a href="some-important-distribution-models.html#chi2-distribution"><i class="fa fa-check"></i><b>3.3.1</b> <span class="math inline">\(\chi^2\)</span>-distribution</a></li>
<li class="chapter" data-level="3.3.2" data-path="some-important-distribution-models.html"><a href="some-important-distribution-models.html#t-distribution"><i class="fa fa-check"></i><b>3.3.2</b> t-distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="limit-theorems.html"><a href="limit-theorems.html"><i class="fa fa-check"></i><b>4</b> Limit theorems</a>
<ul>
<li class="chapter" data-level="4.1" data-path="limit-theorems.html"><a href="limit-theorems.html#strong-law-of-large-numbers"><i class="fa fa-check"></i><b>4.1</b> Strong law of large numbers üí™</a></li>
<li class="chapter" data-level="4.2" data-path="limit-theorems.html"><a href="limit-theorems.html#central-limit-theorem"><i class="fa fa-check"></i><b>4.2</b> Central limit theorem</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="iii-inductive-statistics.html"><a href="iii-inductive-statistics.html"><i class="fa fa-check"></i>III Inductive Statistics</a></li>
<li class="chapter" data-level="5" data-path="parameter-estimation.html"><a href="parameter-estimation.html"><i class="fa fa-check"></i><b>5</b> Parameter estimation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="parameter-estimation.html"><a href="parameter-estimation.html#basic-ideas-of-inductive-statistics"><i class="fa fa-check"></i><b>5.1</b> Basic ideas of inductive statistics</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="parameter-estimation.html"><a href="parameter-estimation.html#parameter-estimation-theoretically"><i class="fa fa-check"></i><b>5.1.1</b> Parameter estimation theoretically</a></li>
<li class="chapter" data-level="5.1.2" data-path="parameter-estimation.html"><a href="parameter-estimation.html#parameter-estimation-practically"><i class="fa fa-check"></i><b>5.1.2</b> Parameter estimation practically</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="parameter-estimation.html"><a href="parameter-estimation.html#point-estimation"><i class="fa fa-check"></i><b>5.2</b> Point estimation</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="parameter-estimation.html"><a href="parameter-estimation.html#estimation-functions"><i class="fa fa-check"></i><b>5.2.1</b> Estimation functions</a></li>
<li class="chapter" data-level="5.2.2" data-path="parameter-estimation.html"><a href="parameter-estimation.html#properties-of-estimators"><i class="fa fa-check"></i><b>5.2.2</b> Properties of estimators</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="parameter-estimation.html"><a href="parameter-estimation.html#construction-of-estimators"><i class="fa fa-check"></i><b>5.3</b> Construction of estimators</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="parameter-estimation.html"><a href="parameter-estimation.html#method-of-moments"><i class="fa fa-check"></i><b>5.3.1</b> Method of moments</a></li>
<li class="chapter" data-level="5.3.2" data-path="parameter-estimation.html"><a href="parameter-estimation.html#maximum-likelihood-method"><i class="fa fa-check"></i><b>5.3.2</b> Maximum likelihood method</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="parameter-estimation.html"><a href="parameter-estimation.html#interval-estimation"><i class="fa fa-check"></i><b>5.4</b> Interval estimation</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="parameter-estimation.html"><a href="parameter-estimation.html#alpha-confidence-interval-for-mu"><i class="fa fa-check"></i><b>5.4.1</b> <span class="math inline">\((1-\alpha)\)</span> confidence interval for <span class="math inline">\(\mu\)</span></a></li>
<li class="chapter" data-level="5.4.2" data-path="parameter-estimation.html"><a href="parameter-estimation.html#alpha-confidence-interval-for-sigma2"><i class="fa fa-check"></i><b>5.4.2</b> <span class="math inline">\((1-\alpha)\)</span> confidence interval for <span class="math inline">\(\sigma^2\)</span></a></li>
<li class="chapter" data-level="5.4.3" data-path="parameter-estimation.html"><a href="parameter-estimation.html#alpha-confidence-interval-for-probability-p"><i class="fa fa-check"></i><b>5.4.3</b> <span class="math inline">\((1-\alpha)\)</span> confidence interval for probability <span class="math inline">\(p\)</span></a></li>
<li class="chapter" data-level="5.4.4" data-path="parameter-estimation.html"><a href="parameter-estimation.html#determining-n-based-on-the-length-of-confidence-intervals"><i class="fa fa-check"></i><b>5.4.4</b> Determining <span class="math inline">\(n\)</span> based on the length of confidence intervals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>6</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="6.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#the-basic-idea-of-statistical-testing"><i class="fa fa-check"></i><b>6.1</b> The basic idea of statistical testing</a></li>
<li class="chapter" data-level="6.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#hypothesis-tests-for-p"><i class="fa fa-check"></i><b>6.2</b> Hypothesis tests for <span class="math inline">\(p\)</span></a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#the-exact-binomial-test"><i class="fa fa-check"></i><b>6.2.1</b> The exact binomial test</a></li>
<li class="chapter" data-level="6.2.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#the-approximate-binomial-test"><i class="fa fa-check"></i><b>6.2.2</b> The approximate binomial test</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#hypothesis-tests-for-mu"><i class="fa fa-check"></i><b>6.3</b> Hypothesis tests for <span class="math inline">\(\mu\)</span></a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#the-gauss-test"><i class="fa fa-check"></i><b>6.3.1</b> The Gauss test</a></li>
<li class="chapter" data-level="6.3.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#the-t-test"><i class="fa fa-check"></i><b>6.3.2</b> The <span class="math inline">\(t\)</span> test</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#type-1-and-type-2-errors"><i class="fa fa-check"></i><b>6.4</b> Type 1 and Type 2 errors</a></li>
<li class="chapter" data-level="6.5" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#exceeding-probability-p-value"><i class="fa fa-check"></i><b>6.5</b> Exceeding probability: <span class="math inline">\(p\)</span> value</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="regression-analysis.html"><a href="regression-analysis.html"><i class="fa fa-check"></i><b>7</b> Regression analysis</a>
<ul>
<li class="chapter" data-level="7.1" data-path="regression-analysis.html"><a href="regression-analysis.html#linear-regression-model-from-descriptive-statistics"><i class="fa fa-check"></i><b>7.1</b> Linear regression model from descriptive Statistics</a></li>
<li class="chapter" data-level="7.2" data-path="regression-analysis.html"><a href="regression-analysis.html#simple-linear-regression-from-a-probabilistic-perspective"><i class="fa fa-check"></i><b>7.2</b> Simple linear regression from a probabilistic perspective</a></li>
<li class="chapter" data-level="7.3" data-path="regression-analysis.html"><a href="regression-analysis.html#estimating-testing-and-forecasting"><i class="fa fa-check"></i><b>7.3</b> Estimating, testing and forecasting</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="regression-analysis.html"><a href="regression-analysis.html#estimating-the-parameters-of-a-linear-regression-model"><i class="fa fa-check"></i><b>7.3.1</b> Estimating the parameters of a linear regression model</a></li>
<li class="chapter" data-level="7.3.2" data-path="regression-analysis.html"><a href="regression-analysis.html#testing-in-linear-regression-model"><i class="fa fa-check"></i><b>7.3.2</b> Testing in linear regression model</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="regression-analysis.html"><a href="regression-analysis.html#forecast-in-linear-regression-models"><i class="fa fa-check"></i><b>7.4</b> Forecast in linear regression models</a></li>
<li class="chapter" data-level="7.5" data-path="regression-analysis.html"><a href="regression-analysis.html#multivariate-linear-regression"><i class="fa fa-check"></i><b>7.5</b> Multivariate linear regression</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistics and Data Science Applications</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="limit-theorems" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Limit theorems<a href="limit-theorems.html#limit-theorems" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<script>
function checkAnswer_mmc(q) {
      const selectedOptions = document.querySelectorAll('input[name="option'+q.id+'"]:checked');
      if (selectedOptions.length === 2) {
        const userAnswers = Array.from(selectedOptions).map(option => option.value);
        const correctAnswers = q.answer;
        const isCorrect = userAnswers.every(answer => correctAnswers.includes(answer));

if (isCorrect) {
          document.getElementById('result'+q.id).textContent = 'Congratulations! Your answer is correct.';
          document.getElementById('result'+q.id).style.color = "green";
        } else {
          document.getElementById('result'+q.id).textContent = `Sorry, incorrect.`;
          document.getElementById('result'+q.id).style.color = "red";
        }
      } else {
        document.getElementById('result'+q.id).textContent = 'Please select two options.';
      }
    }
// numeric
function generateQuestion_num(id) {
      // Generate two random numbers between 2 and 10
      const num1 = Math.floor(Math.random() * 10) + 2;
      const num2 = Math.floor(Math.random() * 10) + 2;
      const x1 = Math.floor(Math.random() * 100) + 2;
      const x2 = Math.floor(Math.random() * 100) + 2;
      const x3 = Math.floor(Math.random() * 100) + 2;
      const x4 = Math.floor(Math.random() * 100) + 2;
      const x5 = Math.floor(Math.random() * 100) + 2;
      const x6 = Math.floor(Math.random() * 100) + 2;

       // Calculate the correct answer
      let answer = num1*Math.sqrt(x1) + num2*Math.sqrt(x2);

      // Return the question and answer as an object
      return {
       // question: num1 + "\\(\\sqrt{x}+\\)"+ num2 + "\\(\\sqrt{y}\\)" + " for \\(x=\\)" + x1 + " and \\(y=\\)" + x2,
        question: [num1,num2,x1,x2,x3,x4,x5,x6],
        answer: answer,
        id: id
      };
    }

function checkAnswer_num(q) {
      const userAnswer = document.getElementById('answer'+q.id).value;
      const isCorrect = Math.round(parseFloat(userAnswer)*10000)/10000 === Math.round(q.answer*10000)/10000;

      if (isCorrect) {
        document.getElementById('result'+q.id).textContent = 'Congratulations! Your answer is correct.';
        document.getElementById('result'+q.id).style.color = "green";
      } else {
        document.getElementById('result'+q.id).textContent = `Sorry, incorrect. The correct answer is ` + Math.round(q.answer*10000)/10000 + '.';
        document.getElementById('result'+q.id).style.color = "red";
      }
  }

// plain multiple choice
  function checkAnswer_match(q) {
      const selectedOption = document.querySelector('input[name="option'+q.id+'"]:checked');
      if (selectedOption) {
        const userAnswer = selectedOption.value;
        const isCorrect = userAnswer === q.answer;

        if (isCorrect) {
          document.getElementById('result'+q.id).textContent = 'Congratulations! Your answer is correct.';
          document.getElementById('result'+q.id).style.color = "green";
        } else {
          document.getElementById('result'+q.id).textContent = `Sorry, incorrect.`;
          document.getElementById('result'+q.id).style.color = "red";
        }
      } else {
        document.getElementById('result'+q.id).textContent = 'Please select an option.';
      }
    }
    
function factorial(n){
  let answer = 1;
  if (n == 0 || n == 1){
    return answer;
  }
  else if(n > 1){
    for(var i = n; i >= 1; i--){
      answer = answer * i;
    }
    return answer;
  }
  else{
    return "number has to be positive."
  }  
}

function binomial(n, k) {
     if ((typeof n !== 'number') || (typeof k !== 'number')) 
  return false; 
    var coeff = 1;
    for (var x = n-k+1; x <= n; x++) coeff *= x;
    for (x = 1; x <= k; x++) coeff /= x;
    return coeff;
}

function binomialCDF(k,n,p) {
    let answer = 0;

    for(var i = 0; i <= k; i++){
      answer = answer + binomial(n,i)*Math.pow(p,i)*Math.pow((1-p),(n-i));
    }
    return answer;
}

function normalCDF(x, mean, std) {
  var x = (x - mean) / std
  var t = 1 / (1 + .2315419 * Math.abs(x))
  var d =.3989423 * Math.exp( -x * x / 2)
  var prob = d * t * (.3193815 + t * ( -.3565638 + t * (1.781478 + t * (-1.821256 + t * 1.330274))))
  if( x > 0 ) prob = 1 - prob
  return prob
}
</script>
<p>We‚Äôve already seen that <strong>empirical</strong><span class="math inline">\(\not=\)</span><strong>theoretical</strong>, at least not entirely. How then are we supposed to understand anything about the population based on a sample?</p>
<p>Well, fortunately there are mathematical guarantees that at least in the limit, i.e.¬†as our sample size gets larger and larger, we get closer and closer to the truth.</p>
<hr />
<p>In this chapter we will learn:</p>
<ul>
<li>What two important limit theorems there are and</li>
<li>what implications arise for our analyses.</li>
</ul>
<hr />
<div id="strong-law-of-large-numbers" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Strong law of large numbers üí™<a href="limit-theorems.html#strong-law-of-large-numbers" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let <span class="math inline">\(X_1,X_2,\ldots\)</span> be a sequence of independent, identically distributed random variables with <span class="math inline">\(\mathbb E(X_i)=\mu\)</span> and <span class="math inline">\(\text{Var}(X_i)=\sigma^2&lt;\infty\)</span>. Then the following applies:
<span class="math display">\[\begin{equation*}
\lim_{n\rightarrow\infty} \frac{1}{n}\sum _{i=1}^n X_i =\mathbb E(X)=\mu\quad\text{ almost sure}.
\end{equation*}\]</span>
‚Äúalmost sure‚Äù is equivalent to ‚Äúwith probability <span class="math inline">\(1\)</span>‚Äù.</p>
<hr />
<div class="example">
<p><span id="exm:probvshaeuf" class="example"><strong>Example 4.1  (empirical frequencies) </strong></span>Using independent repetitions of a stochastic experiment, estimate probability <span class="math inline">\(\mathbb P(A)\)</span> for the occurrence of an event <span class="math inline">\(A,\)</span> given the sample <span class="math inline">\(x_1, x_2, \ldots, x_k,\ldots\)</span></p>
<p>Let <span class="math inline">\(\displaystyle X_k =\begin{cases}1,&amp;\text{ for } x_k\in A\\0 &amp;\text{ for } x_k\not\in A\end{cases}\)</span> <strong>i</strong>ndependent and <strong>i</strong>dentically <strong>d</strong>istributed - <strong>iid</strong> - random variables.</p>
<ul>
<li><span class="math inline">\(\displaystyle\frac{1}{n} \sum_{k=1}^n X_k =h_n(A)=\)</span> relative frequency of occurrence of <span class="math inline">\(A\)</span></li>
<li><span class="math inline">\(\mathbb E(X_k)=\mathbb P(A)\)</span> for all <span class="math inline">\(k\)</span></li>
</ul>
<p>According to the law of large numbers:
<span class="math display">\[h_n(A) \rightarrow \mathbb P(A)\text{ almost sure}.\]</span></p>
</div>
<p>With the strong <strong>L</strong>aw of <strong>L</strong>arge <strong>N</strong>umbers (LLN) we have a guarantee that our sample based estimators eventually converge to the population values when <span class="math inline">\(n\rightarrow\infty\)</span> (asymptotically).</p>
<p>However, as we will see, the values of our estimators (the estimates) depend on the sample. So, what about the distribution of the estimators? The following Central limit theorem helps us to determine the approximative distribution.</p>
<hr />
</div>
<div id="central-limit-theorem" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Central limit theorem<a href="limit-theorems.html#central-limit-theorem" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Central Limit Theorem (ZGS) states that this sum of independent and identically distributed (iid) random variables is <strong>approximately normally distributed</strong>. On this basis we can draw statistical conclusions, e.g.¬†about the distribution of the sample mean over all possible sample realizations!</p>
<p>Let <span class="math inline">\(X_1,X_2, \ldots\)</span> be independent identically distributed random variables with
<span class="math display">\[\begin{equation*}
      \mathbb E(X_i)=\mu\quad\text{ and }\quad
      \text{Var}(X_i)=\sigma^2\text{ with } 0&lt;\sigma^2&lt;\infty.
\end{equation*}\]</span></p>
<p>The following applies to the sum of the random variables:
<span class="math display">\[\begin{equation*}
      \color{blue}{\mathbb E\left(\sum _{i=1}^n X_i\right)}=\color{blue}{n\mu}\quad\text{ and }\quad
      \color{red}{\text{Var}\left(\sum_{i=1}^n X_i\right)}=\color{red}{n\sigma^2}.
\end{equation*}\]</span></p>
<p>Then the distribution function <span class="math inline">\(F_n(z)=\mathbb P(Z_n\leq z)\)</span> of
the <strong>standardized sum</strong>:</p>
<p><span class="math display">\[
      Z_n = \frac{\sum_{i=1}^n X_i - \color{blue}{n\cdot \mu}}{\sqrt{\color{red}{n\cdot\sigma^2}}} %= \sum_{i=1}^n \frac{X_i-\mu}{\sigma/{\sqrt{n}}}
\]</span>
converges for <span class="math inline">\(n\rightarrow\infty\)</span> to <span class="math inline">\(N(z)\)</span> of the <strong>standard normal distribution</strong>:</p>
<p><span class="math display">\[\begin{equation*}
      F_n(z)\rightarrow N(z) \quad \text{ for }n\rightarrow\infty.
\end{equation*}\]</span></p>
<p>That is:
<span class="math display">\[Z_n\stackrel{a}{\sim} N(0,1).\]</span></p>
<p>It follows that for sufficiently large <span class="math inline">\(n\)</span> <strong>the mean is approximately normally distributed</strong>:
<span class="math display">\[\begin{equation*}
    \frac{1}{n}\sum_{i=1}^n X_i\stackrel{a}{\sim} N(\mu,\sigma^2/n).
\end{equation*}\]</span></p>
<hr />
<details>
<summary>
How to compute the mean and the variance for the sample mean
</summary>
<p>Consider a random sample <span class="math inline">\(X_1,X_2,\ldots,X_n\)</span> of iid random variables with <span class="math inline">\(\mathbb E(X_i)=\mu\)</span> and <span class="math inline">\(\text{Var}(X_i)=\sigma^2\)</span> for all <span class="math inline">\(i=1,\ldots, n.\)</span></p>
<p>The sample mean is:
<span class="math display">\[\overline X = \frac 1n\sum_{i=1}^nX_i.\]</span></p>
<p>Using the properties of the expected value:
<span class="math display">\[\begin{align}
\mathbb E(\overline X) &amp;= \mathbb E\left(\frac 1n\sum_{i=1}^nX_i\right)
= \frac 1n\mathbb E\left(\sum_{i=1}^nX_i\right)\\
&amp;= \frac 1n\sum_{i=1}^n\underbrace{\mathbb E\left(X_i\right)}_{=\mu}=\frac 1n \sum_{i=1}^n\mu\\
&amp;= \frac 1n \cdot n\cdot \mu = \mu.
\end{align}\]</span></p>
<span class="math display">\[\begin{align}
\text{Var}(\overline X) &amp;= \text{Var}\left(\frac 1n\sum_{i=1}^nX_i\right)
= \left(\frac 1n\right)^\color{red}{2}\cdot\text{Var}\left(\sum_{i=1}^nX_i\right)\\
&amp;\stackrel{X_i iid}{=} \frac {1^2}{n^2}\cdot \sum_{i=1}^n\underbrace{\text{Var}\left(X_i\right)}_{=\sigma^2}=\frac 1{n^{2}} \sum_{i=1}^n\sigma^2\\
&amp;= \frac 1{n^2} \cdot n\cdot \sigma^2 = \frac{\sigma^2}{n}.
\end{align}\]</span>
</details>
<hr />
<!--
### Approximation von binomialverteilten Zufallsvariablen


- Gegeben: Zufallsvariable $X\sim B(n,p)$ mit hinreichend gro√üem $n$.

- Folgerung: $X=\displaystyle\sum_{k=1}^n X_k$ mit 

    - $X_1,\ldots, X_n$ iid (unabh√§ngig, identisch verteilt)    $B(1,p)$-verteilt (Bernoulli)
    - $\mathbb E(X_k)=p$ und $\text{Var}(X_k)=p(1-p)$ f√ºr $k=1,\ldots, n$ 
    
- $\displaystyle\frac{X-np}{\sqrt{np(1-p)}}$ ist approximativ $N(0,1)$-verteilt

- $\displaystyle\mathbb P(a\leq X\leq b)\approx N\left(\frac{b-np}{\sqrt{np(1-p)}}\right) -N\left(\frac{a-np}{\sqrt{np(1-p)}}\right)$

- Approximation wird besser, wenn Treppenfunktion der Binomialverteilung von Normaldichte in der Mitte getroffen wird. 

- $\displaystyle\mathbb P(a\leq X\leq b)\approx N\left(\frac{b+0,5-np}{\sqrt{np(1-p)}}\right) -N\left(\frac{a-0,5-np}{\sqrt{np(1-p)}}\right)$



***

::: {.example #zgs1 name="Anzahl von App-Nutzern bei einer Befragung"}


Bei einer Befragung von $20$ Kunden m√∂chte man die Anzahl der dabei befragten App-Nutzern modellieren.
$A: \text{Anzahl von App-Nutzern unter den 20 Befragten}$, da $\mathbb P(App) = 0,6$ gilt $A\sim B(n=20,p=0,6)$. Wir bestimmen die Wahrscheinlichkeit $\mathbb P(10\leq A\leq 15)$.

- Exakt: $\displaystyle \mathbb P(10\leq A\leq 15) = \mathbb P(A=10) + \mathbb P(A=11) + \ldots + \mathbb P(A=15) = 0,8215.$ 

- Einfache Approximation: ($\mathbb E(A)=12$, $\text{Var}(A) = 4,8$)
      $\displaystyle \mathbb P(10\leq A\leq 15)\approx N\left(\frac{15-12}{\sqrt{ 4,8}} - N\left(\frac{10-12}{\sqrt{4,8}}\right)\right) = 0,7339$

- Mit Stetigkeitskorrektur:
\begin{align*}
          \displaystyle \mathbb P(10\leq A\leq 15)&=\mathbb P(9,5<A<15,5)\\
&\approx N\left(\frac{15,5-12} {\sqrt{4,8}} - N\left(\frac{9,5-12}{\sqrt{4,8}}\right) \right) \\
            & = 0,818
\end{align*}

:::

***
-->
<div class="example">
<p><span id="exm:zgs2" class="example"><strong>Example 4.2  (Average time in the online shop) </strong></span>In examples <a href="random-variables.html#exm:stZV">2.6</a> and <a href="random-variables.html#exm:stZVkenz">2.7</a> we have modelled <span class="math inline">\(X=\)</span>‚Äútime in the online shop‚Äù as a continuous random variable with the density:</p>
<p><span class="math display">\[
f(x) = \begin{cases}0,001\cdot x , &amp;\text{ f√ºr } 0\leq x\leq 20,\\
                      0,025 -0,00025\cdot x, &amp;\text{ f√ºr } 20&lt; x\leq 100.\end{cases}
\]</span></p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-157"></span>
<img src="_main_files/figure-html/unnamed-chunk-157-1.png" alt="Density function of X=time in the online shop" width="40%" />
<p class="caption">
Figure 4.1: Density function of X=time in the online shop
</p>
</div>
<p>and computed:</p>
<p><span class="math display">\[\begin{align}
\mathbb E(X) &amp;= 40,\\
\text{Var}(X) &amp;= 466,6667.
\end{align}\]</span></p>
<p>Now we draw a pair of samples of size <span class="math inline">\(n\)</span> from this distribution and in each sample realization we take the average of the values. The ZGS states that (although the individual times are obviously <strong>not</strong> normally distributed) the distribution of the (standardized) average will get closer and closer to the (standard) normal distribution as <span class="math inline">\(n\)</span> increases.</p>
<p>That is, <span class="math inline">\(\bar X=\frac 1n(X_1 + \ldots + X_n)\)</span> mit <span class="math inline">\(\mathbb E(\bar X) = n\cdot \frac 1n\cdot \mathbb E(X) = 40\)</span> und <span class="math inline">\(\text{Var}(\bar X)=n\cdot\frac1{n^2}\cdot \text{Var}(X) = \frac{466,6667}{n}.\)</span></p>
<p>For <span class="math inline">\(n=50\)</span> holds:</p>
<p><span class="math display">\[
\bar X\stackrel{a}{\sim} N(40;9,3333)
\]</span></p>
<p>and</p>
<p><span class="math inline">\(\mathbb P(35\leq\bar X\leq 45)\stackrel{\sim}{=}N(\frac{45-40}{\sqrt{9,3333}}) - N(\frac{35-40}{\sqrt{9,3333}}) =0,8983\)</span></p>
<p><img src="images/clt.png" /></p>
</div>
<hr />
<div id="q41" class="quiz">
<p id="question">
<span id="question-text41"></span>
<input type="number" id="answer41" placeholder="Enter your answer"> and
<button onclick="checkAnswer_num(questionObj41)">Submit</button>
</p>
<p id="result41">
</p>
<script>

 const questionObj40 = generateQuestion_num(40);
 // Generate a random question
    const questionObj41 = generateQuestion_num(41);
// Display the question
    document.getElementById('question-text41').textContent = "We want to model the invoice amount (Rechnungsh√∂he) of  \\(i\\)th customer as a random variable \\(R_i\\)  and then model the average invoice amount of  \\(n\\)  customers  \\(\\bar R=\\frac 1n\\sum_{i=1}^nR_i.\\) We assume that the invoice amounts of different customers \\(R_1,\\ldots,R_n\\) are independently and identically distributed with  \\(\\mathbb E(R_i)=" + (questionObj41.question[0]*10) + "\\)  and \\(\\text{Var}(R_i)=" + (questionObj41.question[1]*100) + "\\) but the actual distribution is unknown.\\[\\] Every day, over several days, we calculate the daily average of the invoice amounts of  \\(n=" + (questionObj40.question[0]*10) + "\\) randomly selected customers. How is the average invoice amount approximately distributed?\\[\\]\\(\\bar R\\) is approximately normal distributed with \\[\\]\\(\\mathbb E(\\overline R)=\\)";
    questionObj41.answer = (questionObj41.question[0]*10)
</script>
<p id="question">
<span id="question-text42"></span>
<input type="number" id="answer42" placeholder="Enter your answer">.
<button onclick="checkAnswer_num(questionObj42)">Submit</button>
</p>
<p id="result42">
</p>
<script>

 // Generate a random question
    const questionObj42 = generateQuestion_num(42);
// Display the question
    document.getElementById('question-text42').textContent = "\\(\\text{Var}(\\overline R)=\\)";
    questionObj42.answer = (questionObj41.question[1]*100)/(questionObj40.question[0]*10)
</script>
<p id="question">
<span id="question-text43"></span>
<input type="number" id="answer43" placeholder="Enter your answer">
<button onclick="checkAnswer_num(questionObj43)">Submit</button>
</p>
<p id="result43">
</p>
<script>

 // Generate a random question
    const questionObj43 = generateQuestion_num(43);
// Display the question
    document.getElementById('question-text43').textContent = "Based on the approximative normal distribution, we can calculate \\(\\mathbb P("+(questionObj41.question[0]*10- questionObj43.question[0]) + "\\leq \\bar R\\leq"+ (questionObj41.question[0]*10+ questionObj43.question[1]) + ")\\approx \\)";
    
    questionObj43.answer = normalCDF((questionObj41.question[0]*10+ questionObj43.question[1]), (questionObj41.question[0]*10), Math.sqrt((questionObj41.question[1]*100)/(questionObj40.question[0]*10))) - normalCDF((questionObj41.question[0]*10- questionObj43.question[0]), (questionObj41.question[0]*10), Math.sqrt((questionObj41.question[1]*100)/(questionObj40.question[0]*10)))
</script>
</div>
<!--::: {.exercise name="CLT for the average invoice amount (Rechnungsh√∂he)"}

We want to model the invoice amount of $i$th customer as a random variable $R_i$ and then model the average invoice amount of $n$ customers ($\bar R = \frac 1n\sum_{i=1}^n R_i$). . We assume that the invoice amounts of different customers ($R_1,\ldots, R_n$) are independently and identically distributed with $\mathbb E(R_i) = 30$ and $\text{Var}(R_i) = 900$, but the actual distribution is unknown.

Every day, over several days, we calculate the daily average of the invoice amounts of $n=100$ from randomly selected customers.
**How is the average invoice amount approximately distributed?**


```{=html}
<iframe title="Aufgabe_ZGS" src="./htmls/Aufgabe_ZGS.html" width="760" height="500"></iframe>
```

:::-->
<hr />
<!--
## R√ºckblick{-}


```{=html}
<iframe title="Wortwolke" src="http://learning-dashboard.lehre.hwr-berlin.de:3838/Apps_RBook/#section-wortwolke" width="760" height="600"></iframe>
```
-->

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="some-important-distribution-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="iii-inductive-statistics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/04-limitTheorems.rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
